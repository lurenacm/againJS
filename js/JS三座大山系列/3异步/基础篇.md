> __å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ—ä¸€ä¸€ï¼Œå¼‚æ­¥ç¼–ç¨‹åœ¨ JS ä¸­æ˜¯æ— æ³•é¿å…çš„ï¼Œä¹Ÿæ˜¯é¢è¯•å¿…é—®çš„ã€‚æœ¬æ–‡ä½¿ç”¨é€šä¿—æ˜“æ‡‚çš„è¯­è¨€è§£æå¼‚æ­¥ç¼–ç¨‹ä¸­çš„åŸç†ï¼Œå¼€å§‹é˜…è¯»å§ğŸ˜__
## æ€ç»´å¯¼å›¾


## ä¸€ã€å®šæ—¶å™¨
> å®šæ—¶å™¨ï¼šè®¾å®šä¸€ä¸ªå®šæ—¶å™¨ï¼Œåˆ°äº†è®¾å®šæ—¶é—´ï¼Œæµè§ˆå™¨ä¼šæŠŠå¯¹åº”çš„æ–¹æ³•æ‰§è¡Œã€‚æ¯ä¸€ä¸ªå®šæ—¶å™¨æ‰§è¡Œåéƒ½ä¼šæœ‰ä¸€ä¸ªç¼–å·è¿”å›ï¼Œæ¯ä¸ªå®šæ—¶å™¨ç¼–å·ä¸ä¸€æ ·ã€‚
### 1. è®¾å®šå®šæ—¶å™¨
* setTimeout([function], [interval])
> function éƒ½æ˜¯åœ¨åˆ°è¾¾è®¾å®šæ—¶é—´åæ‰æ‰§è¡Œã€‚ä¸”æ‰§è¡Œä¸€æ¬¡
``` js
let count = 1
let timer = setTimeout(function(){
    count++
    console.log(count)  // 2
}, 1000)
console.log(timer)  // 1
```
* setInterval([function], [interval])
> åœ¨è®¾å®šæ—¶é—´å†…æ‰§è¡Œï¼Œä¸ä¸»åŠ¨åœæ­¢çš„æƒ…å†µä¸‹ä¸€ç›´æ‰§è¡Œã€‚
``` js
let count = 1
let timer = setInterval(function(){
    count++
    console.log(count)  // 2
}, 1000)
console.log(timer)  // 1
/*
*   2
*   3
*   4
*   ...
*/
```
### 2. æ¸…é™¤å®šæ—¶å™¨
> `clearTimeout/clearInterval` ä¸¤è€…éƒ½å¯ä»¥æ¸…é™¤ä¸Šé¢çš„ä¸¤ç§å®šæ—¶å™¨ã€‚
* å¦‚ä½•æ¸…é™¤å®šæ—¶å™¨ï¼Ÿ
> åªéœ€è¦å®šæ—¶å™¨çš„è¿”å›å€¼ç¼–å·æ¸…é™¤å³å¯ã€‚
```js
let count = 1
let timer = setInterval(function(){
    count++
    console.log(count)
    // count == 3 ? clearTimeout(timer) : null
    count == 3 ? clearInterval(timer) : null
}, 1000)
```

## äºŒã€å¼‚æ­¥ç¼–ç¨‹çš„åŸç†
__å…ˆæ¥çœ‹ä¸€ä¸ªå°ä¾‹å­__
``` js
let a = 0
setTimeout(() =>{
    console.log('a', ++a)
}, 0)
console.log(a)
/* è¾“å‡º
*   0
*   1
*/
```
> ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ`setTimeout` æ˜¯å¼‚æ­¥çš„ï¼Œæµè§ˆå™¨ä¼šå°†å¼‚æ­¥çš„ä»£ç åŠ å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œç­‰åˆ°åŒæ­¥çš„ä»£ç æ‰§è¡Œå®Œæˆåæ‰æ‰§è¡Œå¼‚æ­¥çš„ä»£ç 
### 1. åŒæ­¥
> JS æ˜¯å•çº¿ç¨‹çš„ï¼Œä»£ç è‡³ä¸Šè€Œä¸‹æ‰§è¡Œæ—¶é‡åˆ°åŒæ­¥çš„ä»£ç éœ€è¦å…ˆæ‰§è¡Œå®Œæ‰å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥ä»»åŠ¡ã€‚æ¯”å¦‚å¾ªç¯ç­‰

### 2. å¼‚æ­¥
> æ‰€æœ‰éœ€è¦ç­‰å¾…çš„ä»»åŠ¡éƒ½æ˜¯å¼‚æ­¥çš„ã€‚é‡åˆ°å¼‚æ­¥ä»£ç æ—¶ï¼Œä¸éœ€è¦ç­‰å¾…è€Œæ˜¯ç›´æ¥å¼‚æ­¥ä»»åŠ¡æ”¾å…¥ä»»åŠ¡é˜Ÿåˆ—ï¼Œç­‰åˆ°åé¢çš„ä»»åŠ¡å®Œæˆåï¼Œæ‰ä¼šè¿”å›æ¥æ‰§è¡Œæ²¡æœ‰å®Œæˆå¼‚æ­¥çš„ä»£ç ã€‚æ¯”å¦‚äº‹ä»¶ç»‘å®šï¼Œæ‰€æœ‰å®šæ—¶å™¨ï¼Œajax çš„å¼‚æ­¥å¤„ç†ï¼Œéƒ¨åˆ†å›è°ƒå‡½æ•°ï¼Œæµè§ˆå™¨çš„æ¸²æŸ“è¿‡ç¨‹ç­‰ç­‰ã€‚
``` js
let a = 0
setTimeout(() =>{
    console.log('a', ++a)
}, 0)
console.log(a)
while(true){
}
```
> ä¸Šé¢çš„ä»£ç æ­»å¾ªç¯äº†ï¼Œå³ä½¿å®šæ—¶å™¨çš„æ—¶é—´åˆ°äº†ä¹Ÿä¸ä¼šæ‰§è¡Œã€‚å› ä¸ºåŒæ­¥çš„ä»£ç æ²¡æœ‰æ‰§è¡Œå®Œä¸€æ­¥å°±ä¸ä¼šæ‰§è¡Œã€‚

## ä¸‰ã€promise
### 1.åŸºæœ¬æ¦‚å¿µ
> `Promise` åªæ˜¯ä¸€ä¸ªç®¡ç†å¼‚æ­¥ç¼–ç¨‹çš„ç±»ï¼Œæœ¬èº«æ˜¯åŒæ­¥ã€‚`Promise` æœ‰ä¸‰ä¸ªçŠ¶æ€ `pending/fulfilled/rejected`ï¼Œä¸‰ä¸ªçŠ¶æ€åªæœ‰ä¸¤ä¸ªçŠ¶æ€å‡ºç°è¦ä¹ˆæˆåŠŸè¦ä¹ˆå¤±è´¥ã€‚`new Promise()`æ—¶å¿…é¡»è¦ä¼ å…¥å›è°ƒå‡½æ•° `executor`ï¼Œå¦åˆ™æŠ¥é”™ã€‚å…¶ä¸­å›è°ƒå‡½æ•°ä¸­æœ‰ä¸¤ä¸ªå‚æ•° `resolve, reject`ï¼Œè¿™ä¸¤ä¸ªå‚æ•°å¯ä¸å†™ã€‚
* `pending` ï¼šåˆå§‹åŒ–çŠ¶æ€ï¼Œå¼€å§‹æ‰§è¡Œå¼‚æ­¥çš„ä»»åŠ¡ï¼Œåªè¦æ‰§è¡Œ newï¼Œ`new Promise(()=>{})`ï¼Œpromise çš„çŠ¶æ€å°±ä¼šå˜æˆ `pending`
* `fulfilled`ï¼šæˆåŠŸçŠ¶æ€ï¼Œæ‰§è¡Œ `resolve()`ã€‚
* `rejected`ï¼šå¤±è´¥çŠ¶æ€, æ‰§è¡Œ `rejected()`ã€‚
__å…ˆçœ‹ä¸€ä¸ªå°æ —å­ã€‚__
``` js
new Promise(()=> {
    setTimeout(()=> {
        console.log(1)
    }, 0)
    console.log(2)
}).then()
console.log(3)
/* è¾“å‡º
*   2
*   3
*   1
*/
```
> åˆ›å»ºä¸€ä¸ªæ–°çš„ `Promise` çš„å®ä¾‹ä¹Ÿå°±æ˜¯ `new` è¿™ä¸ªè¿‡ç¨‹ä¸­ä¼šæŠŠ `Promise ä¸­` çš„å‡½æ•°å…ˆæ‰§è¡Œ(ä¸æ¸…æ¥š `new` åˆ›å»ºå®ä¾‹çš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†ä»€ä¹ˆå¯ä»¥çœ‹çœ‹è¿™ç¯‡ [é¢è¯• | ä½ ä¸å¾—ä¸æ‡‚å¾— JS åŸå‹å’ŒåŸå‹é“¾](https://juejin.cn/post/6938590449674223624#heading-6))ã€‚å‡½æ•°ä½“å†…æœ‰å¼‚æ­¥æ“ä½œçš„ä»ä¼šåŠ å…¥ä»»åŠ¡é˜Ÿåˆ—ï¼Œç­‰åˆ°åŒæ­¥æ‰§è¡Œå®Œæˆåæ‰æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ï¼Œæ¯”å¦‚å‡½æ•°ä½“å†…çš„ `setTimeout å‡½æ•°`ã€‚æ‰€ä»¥è¾“å‡ºçš„ç»“æœå°±æ˜¯ `2ï¼Œ3ï¼Œ1`ã€‚

__å†æ¥çœ‹ä¸€ä¸ªå°æ —å­__
``` js
const promise = new Promise((resolve, reject) => {
  resolve('success1')
  reject('error')
  resolve('success2')
})

promise.then((res) => {
    console.log('then: ', res)
}).catch((err) => {
    console.log('catch: ', err)
}
// then: success1
```
> promise çš„çŠ¶æ€åªèƒ½æ”¹å˜ä¸€æ¬¡ï¼Œæœ€åçš„çŠ¶æ€ä¸æ˜¯ `fulfilled` å°±æ˜¯ `rejected`ã€‚ä¹Ÿå°±æ˜¯è¯´åŒä¸€ä¸ª `promise` ä¸­çš„`resolve()/ reject()`åªèƒ½æ‰§è¡Œä¸€ä¸ªä¸”ä¸€æ¬¡ã€‚

### 2. promise æ˜¯æ€ä¹ˆç®¡ç†å¼‚æ­¥çš„
> `promise` å‚æ•°çš„å›è°ƒå‡½æ•°ä½“å†…æ¥æ”¶ä¸¤ä¸ªå‚æ•° `resolve/ reject`ï¼Œè¿™ä¸¤ä¸ªå‚æ•°å¯ä»¥ä½œä¸ºä¸¤ä¸ªå›è°ƒå‡½æ•°ã€‚
> 1. `resolve()`ï¼šæ˜¯å¼‚æ­¥æ“ä½œæ‰§è¡ŒæˆåŠŸåæ‰§è¡Œï¼Œpromise çš„çŠ¶æ€å˜æˆäº† `fulfilled`ï¼Œå¯ä»¥æä¾›è¿”å›å€¼ï¼Œåœ¨ `.then()`ä¸­ç¬¬ä¸€ä¸ªå‚æ•°æ¥æ”¶
> 2. `reject()`ï¼šå¼‚æ­¥æ“ä½œæ‰§è¡Œå¤±è´¥åæ‰§è¡Œï¼Œpromise çš„çŠ¶æ€å˜æˆäº† `rejected`ï¼Œå¯ä»¥æä¾›è¿”å›å€¼ï¼Œåœ¨ `.then()` ä¸­ç¬¬äºŒä¸ªå‚æ•°æ¥æ”¶
> `resolve()` å’Œ `reject()` ä¸­åªèƒ½ä¼ é€’ä¸€ä¸ªå‚æ•°ã€‚promise çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜åä¸ä¼šå†å˜åŒ–ã€‚
> `resolve() å’Œ reject() æ˜¯å¼‚æ­¥æ“ä½œ`ï¼Œæ‰§è¡Œè¿™ä¸¤ä¸ªæ–¹æ³•æ—¶ï¼Œä¼šå…ˆæ‰§è¡Œ `resolve/reject` ä¸‹é¢çš„åŒæ­¥ä»£ç ï¼Œç­‰åˆ°ä¸»ä»»åŠ¡ä¸ºç©ºæ—¶ï¼Œå†å»è°ƒç”¨ `resolve/reject` æŠŠå­˜æ”¾çš„æ–¹æ³•æ‰§è¡Œã€‚
> `Promise` å¯¹è±¡ä¸Šæœ‰ç§æœ‰å±æ€§`Promise.resolve()/ Promise.reject()`ç­‰ã€‚
__ä¸¾ä¸€ä¸ªæ²¡ä»€ä¹ˆæ„ä¹‰çš„å°æ —å­__
``` js
new Promise((resolve, reject)=> {
    setTimeout(()=> {
        console.log('æ—')
        resolve('ok')
        // reject('fail')
        console.log('ä¸€ä¸€')
    }, 0)
}).then( res => {
    console.log('status:', res)
}, res => {
    console.log('status:', res)
})
// æ— 
// ä¸€ä¸€ 
// ok
```
> ä¸Šé¢çš„æ —å­ç›´æ¥çœ‹å‡º `resolve/reject` æ˜¯å¼‚æ­¥çš„ã€‚

### 3. promise.then(onfulfilled, onrejected) / promise.catch() 
* `promise.then(onfulfilled, onrejected)`
> 1. `promise.then()` æ–¹æ³•ä¸­æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«å¯¹åº”ç€ promise çš„ä¸¤ç§ä¸åŒçš„çŠ¶æ€ï¼Œ`fulfilled, rejected`ã€‚å¯¹åº”çš„çŠ¶æ€æ‰§è¡Œå¯¹åº”çš„æ–¹æ³•ã€‚
> 2. `promise.then()` ä¸­çš„å‚æ•°æ˜¯å‡½æ•°ï¼Œå¦‚æœä¼ é€’çš„ä¸æ˜¯å‡½æ•°å°±ä¼šé€ æˆ`å€¼ç©¿é€`ï¼Œä¹Ÿå°±æ˜¯`resolve()/reject()` çš„è¿”å›å€¼ä¼š`.then()`ä¸­æ¥æ”¶ã€‚
> 3. `promise.then()` èƒ½å¤Ÿé“¾å¼çš„è°ƒç”¨ï¼Œèƒ½å¤Ÿé“¾å¼è°ƒç”¨çš„åŸå› ä¸æ˜¯`.then()` æ–¹æ³•ä¸­æœ‰`return this`ï¼Œè€Œæ˜¯æ¯ä¸€ä¸ª `.then()` æ–¹æ³•ä¸­éƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„`Promise` å®ä¾‹ã€‚

* `promise.catch()`
> 1. `promise.catch()` æ˜¯ `promise.then()` ç¬¬äºŒä¸ªå‚æ•°çš„ç®€ä¾¿å†™æ³•ï¼Œä¹Ÿå°±æ˜¯ç”¨æ¥æ•è· `reject()` æ‰§è¡Œåçš„ `rejected`çŠ¶æ€ã€‚
> 2. `.catch()`ä¹Ÿå¯ä»¥å®ç°é“¾å¼è°ƒç”¨ï¼ŒåŸå› å’Œ`.then()` æ–¹æ³•ä¸€æ ·éƒ½æ˜¯è¿”å›äº†ä¸€ä¸ªæ–°çš„ `promise`ã€‚

__`.then()/.catch()` ä¸­çš„è¿”å›å€¼éƒ½ä¸èƒ½æ˜¯ `promise`è‡ªå·±æœ¬èº«çš„å®ä¾‹ï¼Œå› ä¸ºä¼šé€ æˆæ­»å¾ªç¯__
#### çƒ­èº«é¢˜
#### 1.ä¸¾ä¸€ä¸ªå°æ —å­
``` js
Promise.resolve(1)
    .then((res) => {
        console.log(res)
        return 2
    }).catch(err => {
        console.log(err)
    }).then( res => {
        console.log(res)
    })
// 1 2
```
> æœ€ç»ˆè¾“å‡º `1 2`,

#### 2. ä¸¾ä¸€ä¸ªå€¼ç©¿é€çš„å°æ —å­
``` js
Promise.resolve(1)
  .then(2)
  .then(Promise.resolve(3))
  .then(console.log)

// ç­‰ä»·äº
// Promise.resolve(1)
//   .then(console.log)
```
#### 3. then()/.catch() å†…ä¸èƒ½è¿”å›è‡ªå·±æœ¬èº«çš„promise å®ä¾‹ï¼Œä¸¾ä¸€ä¸ªæ —å­
``` js
let pro = Promise.resolve()
  .then(() => {
    console.log('promise', pro)
    return pro
  })
// Uncaught (in promise) TypeError: Chaining cycle detected for promise #<Promise>
```
> åˆ›å»ºçš„`promise` å®ä¾‹æ˜¯`pro`ï¼Œè¿”å›å€¼å°±ä¸èƒ½æ˜¯`pro`, å¦åˆ™ä¼šé€ æˆæ­»å¾ªç¯ã€‚

### 5. Promise.all([promise1, promise2...])
> `Promise.all()` ä¸­éœ€è¦ç­‰å¾…å‚æ•°ä¸­æ‰€æœ‰ `promise` çš„çŠ¶æ€éƒ½æˆåŠŸæ‰æ‰§è¡Œå›è°ƒçš„ `.then()`ï¼Œå¦‚æœæœ‰ä¸€ä¸ªæ˜¯å¤±è´¥çš„é‚£ä¹ˆå°±æ‰§è¡Œ `.catch()`ã€‚æ¥æ”¶çš„å‚æ•°æ˜¯ä¸€ä¸ªåŒ…å« `promise` å®ä¾‹çš„æ•°ç»„ï¼Œ`.all()` è¿™ä¸ªæ–¹æ³•çš„è¿”å›å€¼ä¹Ÿæ˜¯ä¸€ä¸ªæ–°çš„ `promise` å®ä¾‹ã€‚`.all([])` å¯ä»¥ä¸æ˜¯æ•°ç»„ï¼Œä½†å¿…é¡»å…·æœ‰ Iterator æ¥å£ã€‚
* å¦‚æœå‚æ•°ä¸æ˜¯ä¸€ä¸ª Promise å®ä¾‹ï¼Œä¼šå…ˆè°ƒç”¨ `Promise.resolve()` è½¬åŒ–æˆ `Promise` å®ä¾‹
* å…¨éƒ¨æ‰§è¡ŒæˆåŠŸå›è°ƒ `.then()` æ¥æ”¶åˆ°çš„å°±æ˜¯ä¸€ä¸ªæ•°ç»„
* å¦‚æœæœ‰æ‰§è¡Œå¤±è´¥çš„ `promise` çŠ¶æ€ï¼Œå›è°ƒ `.catch` ä¸­å°±ä¼šæ•è·åˆ°æ‰§è¡Œå¤±è´¥çš„ `promise`ï¼Œ`promise.all()` æ‰§è¡Œç»“æŸã€‚
* 
``` js
var p1 = 1
var p2 = Promise.resolve(2)
var p3 = Promise.resolve(3)
let pro =  Promise.all([p1, p2, p3])
  .then(res => {
      console.log(res)  // Â [1, 2, 3]
  })
  .catch( err => {
      console.log(err)
  })
console.log(pro)    // PromiseÂ {<pending>}
```
> å…¨éƒ¨æ‰§è¡ŒæˆåŠŸï¼Œé‚£ä¹ˆ`.then()` è·å–åˆ°çš„å€¼å°±æ˜¯`resolve()` çš„è¿”å›å€¼æ•°ç»„ã€‚
### 6. Promise.race()
> `.race()` çš„ä½œç”¨ä¹Ÿæ˜¯æ¥æ”¶ä¸€ç»„å¼‚æ­¥ä»»åŠ¡ï¼Œç„¶åå¹¶è¡Œæ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ï¼Œåªä¿ç•™å–ä¸€ä¸ªæœ€å¿«æ‰§è¡Œå®Œæˆçš„å¼‚æ­¥æ“ä½œçš„ç»“æœï¼Œå…¶ä»–çš„æ–¹æ³•ä»åœ¨æ‰§è¡Œï¼Œä¸è¿‡æ‰§è¡Œç»“æœä¼šè¢«æŠ›å¼ƒã€‚
*  æ¥æ”¶çš„æ˜¯ä¸€ç»„æ•°ç»„ï¼Œåªè·å–ä¸€ä¸ªæœ€å¿«æ‰§è¡Œå®Œæˆ `resolve()/rejected()` çš„è¿”å›å€¼ï¼Œè¿”å›å€¼ä¸æ˜¯ä¸€ä¸ªæ•°ç»„
``` js
var p1 = new Promise(function(resolve, reject) {
    setTimeout(reject, 500, "one");
});
var p2 = new Promise(function(resolve, reject) {
    setTimeout(resolve, 100, "two");
});

Promise.race([p1, p2]).then(function(value) {
  console.log(value); // "two"
});
```
> ä¸¤ä¸ªéƒ½å®Œæˆï¼Œä½† p2 æ›´å¿«

### 7. Promise.finally()
> `.finally` æ–¹æ³•ä¹Ÿæ˜¯è¿”å›ä¸€ä¸ª `Promise`ï¼Œä»–åœ¨ `Promise` ç»“æŸçš„æ—¶å€™ï¼Œæ— è®ºç»“æœä¸º `resolved` è¿˜æ˜¯ `rejected`ï¼Œéƒ½ä¼šæ‰§è¡Œé‡Œé¢çš„å›è°ƒå‡½æ•°ã€‚
``` js
let promise = new Promise((resolve, reject) => {
    reject('error')
}).then( res => {
    console.log('then', res)
    return res
}).catch( err => {
    console.log('catch', err)   // `catch error`
     return err
}).finally( () => {
    console.log('finally')  //'finally'
})
```

### çƒ­èº«é¢˜
#### çƒ­èº«é¢˜1
``` js
const promise = new Promise((resolve, reject) => {
  console.log(1)
  resolve()
  console.log(2)
})
promise.then(() => {
  console.log(3)
})
console.log(4)
// 1, 2, 4, 3
```
> å› ä¸º `resolve()` æ˜¯å¼‚æ­¥çš„ï¼Œ`promise.then`ä¹Ÿæ˜¯å¼‚æ­¥çš„ï¼Œåœ¨æ²¡æœ‰è·å–åˆ° `resolve()` çš„`fulfilled` çŠ¶æ€æ—¶`.then()` ä¸ä¼šæ‰§è¡Œã€‚

#### çƒ­èº«é¢˜2
``` js
const promise = new Promise((resolve, reject) => {
  setTimeout(() => {
    console.log('once')
    resolve('success')
  }, 1000)
})

const start = Date.now()
promise.then((res) => {
  console.log(res, Date.now() - start)
})
promise.then((res) => {
  console.log(res, Date.now() - start)
})
/* è¾“å‡º
* once
* success 1002
* success 1002
*/
```
> `promise.then()` å³ä½¿æœ‰å¤šä¸ªï¼Œä½†æ˜¯`resolve()/reject()`åçš„è°ƒç”¨æ—¶åŒæ—¶æ‰§è¡Œçš„ã€‚æ‰€ä»¥åŒæ—¶è¾“å‡ºäº† `success 1002`

## ä¸‰ã€async å’Œ await 
__å…ˆæ¥çœ‹ä¸€ä¸ªæ —å­__
``` js
function fn(){
    return new Promise((resolve, reject) => {
        setTimeout( () => {
            Math.random() < 0.5 ? resolve('resolve 001') : reject('reject 002')
        }, 0)
    })
}

async function get() {
    let res = await fn()
    console.log(res)
    console.log(1212)
}
get()
```
### 1. async
>1. `async` å’Œ `await` æ˜¯ ES7 ä¸­å¢åŠ æ¥å¯¹ `promise` æ“ä½œçš„æ–¹æ³•ï¼Œæ˜¯ ES7 ç³»åˆ—æä¾›çš„è¯­æ³•ç³–ï¼Œ`await` ä¸èƒ½å•ç‹¬ä½¿ç”¨ä¸€å®šè¦ç»“åˆ `async` æ¥ä½¿ç”¨ã€‚
>2. `async` ä¼šè¿”å›ä¸€ä¸ª `promise`  å¯¹è±¡ï¼Œ`async` å‡½æ•°è°ƒç”¨ä¸ä¼šé€ æˆä»£ç çš„é˜»å¡
### 2. await
>1. `await` æ˜¯ç”¨æ¥ `ç­‰å¾…è·å–` ä¸€ä¸ª `promise` çš„ `resolve/reject` çš„æ‰§è¡Œç»“æœï¼Œåƒä¸Šé¢çš„ `let res = await fn()` æ˜¯å…ˆæŠŠ `fn()`æ‰§è¡Œåï¼Œæ¥è·å– `resolve/reject` è¿”å›çš„ç»“æœï¼Œä¸è¿‡ `await` åé¢ä¹Ÿå¯ä»¥ä¸è·Ÿç€ä¸€ä¸ª `promise`ï¼Œä½†æ˜¯è¿™æ ·å†™å°±æ²¡æœ‰æ„ä¹‰äº†ã€‚
>2. `await æˆ– await fn()` è¿™ä¸ªæ“ä½œä¸æ˜¯åŒæ­¥çš„ï¼Œè€Œæ˜¯å¼‚æ­¥çš„ã€‚`await` ä¸‹é¢çš„ä»£ç ä¸ä¼šæ‰§è¡Œï¼Œè€Œæ˜¯ç§»å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—ç­‰å¾…åŒºï¼Œç­‰åˆ°ä¸»æ ˆä¸­çš„å…¶ä»–ä»»åŠ¡å®Œæˆä¸” `fn()` ä¸­çš„ `promise` å°†ç»“æœè¿”å›ï¼Œ`await` ä¸‹é¢çš„ä»£ç æ‰å¯ä»¥é‡æ–°å›åˆ°ä¸»æ ˆä¸­æ‰§è¡Œã€‚`await` å¯ä»¥ä½¿ `promise` çš„æ“ä½œæ›´åŠ åƒåŒæ­¥çš„ä»£ç ã€‚
>3. å¦‚æœ await ç­‰åˆ°çš„è·å–ç»“æœæ˜¯ `reject()` è¿”å›çš„ï¼Œé‚£ä¹ˆ `await` ä¸‹é¢çš„ä»£ç ï¼Œå°±ä¸ä¼šå†æ‰§è¡Œï¼Œå› ä¸ºå·²ç»æŠ¥é”™äº†ã€‚
__ä¸¾ä¸€ä¸ªå°æ —å­,è¯´æ˜ async/await æ˜¯è¯­æ³•ç³–__
``` js
async function async1() {
	console.log('async1 start');
	await async2();
	console.log('async1 end');
}
// ä¸Šé¢çš„ä»£ç ç­‰ä»·äº ==>
async function async1() {
    console.log('async1 start');
    Promise.resolve(async2()).then(() => {
        console.log('async1 end')
    })
}
```

### æ€è€ƒ
#### çƒ­èº«1ï¼Œawait æ˜¯åŒæ­¥å—ï¼Ÿï¼Œæ±‚è¾“å‡ºçš„ç»“æœ
``` js
console.log(1)
function fn(){
    return new Promise((resolve, reject) => {
        console.log(5)
        resolve('resolve 001')
        console.log(6)
    })
}

async function get() {
    console.log(2)
    let res = await fn()
    console.log(res)
    console.log(3)
}
get()
console.log(4)
//1, 2, 5, 6, 4, resolve 001, 3
```
>`await` æ˜¯å¼‚æ­¥çš„åŒæ—¶ä¼šè®©å‡ºçº¿ç¨‹ï¼Œ`fn()` æ‰§è¡Œåçº¿ç¨‹å¼€å§‹è®©å‡ºï¼Œé‚£ä¹ˆ `await` çš„åé¢çš„ä»£ç ä¸ä¼šç«‹å³æ‰§è¡Œä¼šå…ˆåˆ°ä¸»æ ˆçš„ç­‰å¾…åŒºï¼Œä¸»æ ˆä¸­ `console.log(4)` æ‰§è¡Œåï¼Œå†å›æ¥æ‰§è¡Œ `await` å¤„çš„ä»£ç ã€‚

### 2. çƒ­èº«2ï¼Œæ±‚è¾“å‡ºç»“æœ
```js
console.log(1)
async function get() {
    console.log(2)
    let res = await 200
    console.log(res)
    console.log(3)
}
get()
console.log(4)
// 1, 2, 4, 200, 3
```
> æ ¹æ®ä¸Šé¢ä¸€é¢˜  `await` å¼‚æ­¥ä»£ç çš„åŸå› ï¼Œå¯ä»¥å®¹æ˜“çš„åˆ†æå‡ºç­”æ¡ˆã€‚åŒæ—¶è¯´æ˜ `await` åé¢ä¹Ÿå¯ä»¥è·Ÿç€ä¸€ä¸ªé `promise` çš„å®ä¾‹ã€‚

## å››ã€ç»å…¸é¢è¯•é¢˜
### 1. promise çš„ä¼˜ç¼ºç‚¹/ä¸ºä»€ä¹ˆä½¿ç”¨ promiseï¼Ÿ
* ä¼˜ç‚¹ï¼špromise å¯ä»¥è§£å†³å›è°ƒåœ°ç‹±ï¼Œpromise å¤§å¤§å¢å¼ºäº†åµŒå¥—å‡½æ•°çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œ
* ç¼ºç‚¹ï¼šæ— æ³•å–æ¶ˆ Promiseï¼Œé”™è¯¯éœ€è¦é€šè¿‡å›è°ƒå‡½æ•°æ¥æ•è·ï¼›å¦‚æœä¸è®¾ç½®å›è°ƒå‡½æ•°ï¼ŒPromise å†…éƒ¨æŠ›å‡ºçš„é”™è¯¯ï¼Œä¸ä¼šåæ˜ åˆ°å¤–éƒ¨ï¼›å½“å¤„äº pendingï¼ˆç­‰å¾…ï¼‰çŠ¶æ€æ—¶ï¼Œæ— æ³•å¾—çŸ¥ç›®å‰è¿›å±•åˆ°å“ªä¸€ä¸ªé˜¶æ®µï¼Œæ˜¯åˆšåˆšå¼€å§‹è¿˜æ˜¯å³å°†å®Œæˆ

### 2. setTimeoutã€Promiseã€Async/Await çš„åŒºåˆ«
* setTimeout: setTimeout çš„å›è°ƒå‡½æ•°æ”¾åˆ°å®ä»»åŠ¡é˜Ÿåˆ—é‡Œï¼Œç­‰åˆ°æ‰§è¡Œæ ˆæ¸…ç©ºä»¥åæ‰§è¡Œ
* Promise: Promise æœ¬èº«æ˜¯åŒæ­¥çš„ç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œå½“åœ¨ executor ä¸­æ‰§è¡Œ resolveæˆ–è€… reject çš„æ—¶å€™ï¼Œæ­¤æ—¶æ˜¯å¼‚æ­¥æ“ä½œï¼Œä¼šå…ˆæ‰§è¡Œ then/catch ç­‰ï¼Œå½“ä¸»æ ˆå®Œæˆæ—¶ï¼Œæ‰ä¼šå»è°ƒç”¨ resolve/reject æ–¹æ³•ä¸­å­˜æ”¾çš„æ–¹æ³•ã€‚
* async: async å‡½æ•°è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå½“å‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œä¸€æ—¦é‡åˆ° await å°±ä¼šå…ˆè¿”å›ï¼Œç­‰åˆ°è§¦å‘çš„å¼‚æ­¥æ“ä½œå®Œæˆï¼Œå†æ‰§è¡Œå‡½æ•°ä½“å†…åé¢çš„è¯­å¥ã€‚å¯ä»¥ç†è§£ä¸ºï¼Œæ˜¯è®©å‡ºäº†çº¿ç¨‹ï¼Œè·³å‡ºäº† async å‡½æ•°ä½“ã€‚

### 3. å®ç°ä¸€ä¸ª sleep å‡½æ•°ï¼Œæ¯”å¦‚ sleep(1000) æ„å‘³ç€ç­‰å¾… 1000 æ¯«ç§’ã€‚
``` js
function sleep1(time) {
    return new Promise(resolve => {
        setTimeout(() => {
            resolve();
        }, time);
    })
}
sleep1(1000).then(() => console.log("sleep1"));
```

### 4. Promise æ„é€ å‡½æ•°æ˜¯åŒæ­¥æ‰§è¡Œè¿˜æ˜¯å¼‚æ­¥æ‰§è¡Œï¼Œé‚£ä¹ˆ then æ–¹æ³•å‘¢
> `Promise` æ˜¯åŒæ­¥çš„ï¼Œæ‰§è¡Œ `new promise(callback)` æ—¶å›è°ƒå‡½æ•°`callback` å°±ä¼šè¢«ç«‹å³æ‰§è¡Œï¼Œ`then()` æ–¹æ³•æ˜¯å¼‚æ­¥çš„ã€‚
``` js
const promise = new Promise((resolve, reject) => {
    console.log(1)
    resolve()
    console.log(2)
})
promise.then(() => {
    console.log(3)
})
console.log(4)
```
> 1243ï¼Œpromise æ„é€ å‡½æ•°æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œthen æ–¹æ³•æ˜¯å¼‚æ­¥æ‰§è¡Œçš„

### 5. ä»‹ç»ä¸‹ Promise.all ä½¿ç”¨ã€åŸç†å®ç°åŠé”™è¯¯å¤„ç†
``` js
const p = Promise.all([p1, p2, p3]);
```
> Promise.all æ–¹æ³•æ¥å—ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°ï¼Œp1ã€p2ã€p3 éƒ½æ˜¯ Promise å®ä¾‹ï¼Œå¦‚æœä¸æ˜¯ï¼Œå°±ä¼šå…ˆè°ƒç”¨ä¸‹é¢è®²åˆ°çš„ promise.resolve æ–¹æ³•ï¼Œå°†å‚æ•°è½¬ä¸º Promise å®ä¾‹ï¼Œå†è¿›ä¸€æ­¥å¤„ç†ã€‚ï¼ˆPromise.all æ–¹æ³•çš„å‚æ•°å¯ä»¥ä¸æ˜¯æ•°ç»„ï¼Œä½†å¿…é¡»å…·æœ‰ Iterator æ¥å£ï¼Œä¸”è¿”å›çš„æ¯ä¸ªæˆå‘˜éƒ½æ˜¯ Promise å®ä¾‹ã€‚ï¼‰

### 5. ä»‹ç»ä¸‹ Promise.all, Promise.race() çš„åŒºåˆ«
> çœ‹ä¸Šé¢çš„ä»‹ç»

## Promise çš„å„ç§ api å®ç°ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­å®ç°ã€‚ç»™ä¸ªæœŸå¾…å§ğŸ˜‚

## äº”ã€å‚è€ƒ
[Promise å¿…çŸ¥å¿…ä¼šï¼ˆåé“é¢˜ï¼‰](https://juejin.cn/post/6844903509934997511)

[BATå‰ç«¯ç»å…¸é¢è¯•é—®é¢˜ï¼šå²ä¸Šæœ€æœ€æœ€è¯¦ç»†çš„æ‰‹å†™Promiseæ•™ç¨‹](https://juejin.cn/post/6844903625769091079#heading-0)

[MDN async/await](https://developer.mozilla.org/zh-CN/docs/Learn/JavaScript/Asynchronous/Async_await)

## å…­ã€ç»“æŸ
> __æ„Ÿè°¢é˜…è¯»åˆ°è¿™é‡Œï¼Œå¦‚æœç€ç¯‡æ–‡ç« èƒ½å¯¹ä½ æœ‰ä¸€ç‚¹å¯å‘æˆ–å¸®åŠ©çš„è¯æ¬¢è¿  [github star](https://github.com/lurenacm/againJS/issues), æˆ‘æ˜¯æ—ä¸€ä¸€,ä¸‹æ¬¡è§ã€‚__






