## 闭包
> 了解闭包前先来了解一下上级作用域和堆栈内存释放问题。
### 上级作用域的概念
* 函数的上级作用域在哪里创建创建的，上级作用域就是谁
``` js
var a = 10
function foo(){
    console.log(a)
}

function sum() {
    var a = 20
    foo()
}

sum()
/* 输出
    10
/
```
>__函数 `foo()` 是在全局下创建的，所以 `a` 的上级作用域就是 `window`，输出就是 `10`__

#### 思考题
``` js
var n = 10
function fn(){
    var n =20
    function f() {
       n++;
       console.log(n)
     }
    f()
    return f
}

var x = fn()
x()
x()
console.log(n)
/* 输出
*  21
    22
    23
    10
/
```
>__思路：`fn` 的返回值是什么变量 `x` 就是什么，这里 `fn` 的返回值是函数名 `f` 也就是 `f` 的堆内存地址，`x()` 也就是执行的是函数 `f()`，而不是 `fn()`，输出的结果显而易见__

### JS 堆栈内存释放
* 堆内存：存储引用类型值，对象类型就是键值对，函数就是代码字符串。
* 堆内存释放：将引用类型的空间地址变量赋值成 `null`，或没有变量占用堆内存了浏览器就会释放掉这个地址

* 栈内存：提供代码执行的环境和存储基本类型值。
* 栈内存释放：一般当函数执行完后函数的私有作用域就会被释放掉。
>__但栈内存的释放也有特殊情况：① 函数执行完，但是函数的私有作用域内有内容被栈外的变量还在使用的，栈内存就不能释放里面的基本值也就不会被释放。② 全局下的栈内存只有页面被关闭的时候才会被释放__

## 闭包是什么
>__关于闭包的定义五花八门，这里引用MDN 对闭包的定义为：闭包是指那些能够访问自由变量的函数。据说前端界面试时都会说形成一个不被销毁的作用域就是闭包__
> 能够读取其他函数内部变量的函数
MDN 对闭包的定义为：

>闭包是指那些能够访问自由变量的函数。

那什么是自由变量呢？

> 自由变量是指在函数中使用的，但既不是函数参数也不是函数的局部变量的变量。

由此，我们可以看出闭包共有两部分组成：

闭包 = 函数 + 函数能够访问的自由变量

* 闭包的作用：保护函数的私有变量不受外部的干扰。形成不销毁的栈内存，把一些值保存下来。

